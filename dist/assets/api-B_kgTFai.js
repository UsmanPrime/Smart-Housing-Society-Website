const m="https://nextgen-residency.onrender.com";function f(){try{return localStorage.getItem("token")}catch(e){return console.error("Error retrieving auth token:",e),null}}async function s(e,{method:o="GET",body:r,token:c,headers:u,skipAuth:h=!1}={}){const i=h?c:c||f(),d={...r instanceof FormData?{}:{"Content-Type":"application/json"},...i?{Authorization:`Bearer ${i}`}:{},...u};try{const t=await fetch(`${m}${e}`,{method:o,headers:d,body:r?r instanceof FormData?r:JSON.stringify(r):void 0,credentials:"include"});if(!t.ok){let n;try{n=await t.json()}catch{n={message:t.statusText}}t.status===401&&(console.error("Unauthorized access - redirecting to login"),localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.pathname.includes("/login")||(window.location.href="/login")),t.status===403&&console.error("Forbidden access:",n.message);const a=new Error(n.message||"Request failed");throw a.status=t.status,a.data=n,a}const l=t.headers.get("content-type")||"";return l.includes("application/json")?t.json():l.includes("text/csv")?t.blob():t.text()}catch(t){throw t.name==="TypeError"&&t.message==="Failed to fetch"?(console.error("Network error - server may be offline"),new Error("Unable to connect to server. Please check your connection.")):t}}const g={get:(e,o)=>s(e,{...o,method:"GET"}),post:(e,o,r)=>s(e,{...r,method:"POST",body:o}),put:(e,o,r)=>s(e,{...r,method:"PUT",body:o}),patch:(e,o,r)=>s(e,{...r,method:"PATCH",body:o}),delete:(e,o)=>s(e,{...o,method:"DELETE"})};export{m as A,g as a};
