import{j as e,N as j,F as f}from"./index-BR_n0HI9.js";import{r as i}from"./react-core-Ljpx9oFu.js";import{u as N}from"./useAuth-4QJvpUN4.js";import{a as y}from"./api-B_kgTFai.js";import{S as v,P as b,C as w}from"./ComplaintDetailModal-nxr4TCG5.js";import"./vendor-B9ygI19o.js";import"./useComplaints-BOdCs5Ff.js";function k({c:s,onSelect:r,onAction:n,canAct:g}){const a=d=>{if(!d)return"";const t=Math.floor((Date.now()-new Date(d).getTime())/1e3);if(t<60)return`${t}s ago`;const o=Math.floor(t/60);if(o<60)return`${o}m ago`;const l=Math.floor(o/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-[#06164a] truncate",children:s.title}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[s.category," â€¢ ",s.location||"No location"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["Created ",a(s.createdAt)]})]}),e.jsxs("div",{className:"flex gap-1 flex-wrap flex-shrink-0",children:[e.jsx(v,{status:s.status}),e.jsx(b,{priority:s.priority})]})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:s.description}),s.submittedBy&&e.jsxs("div",{className:"text-xs text-gray-600",children:["Submitted by: ",e.jsx("span",{className:"font-medium",children:s.submittedBy.name})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsx("button",{onClick:()=>r(s),className:"w-full text-sm px-3 py-2 rounded bg-[#07164a] text-white hover:bg-[#0a1f6b] transition-colors",children:"View Details"})})]})}function P(){const{user:s,isVendor:r}=N(),[n,g]=i.useState([]),[a,d]=i.useState({open:0,"in-progress":0,completed:0,total:0}),[t,o]=i.useState(!0),[l,c]=i.useState(null);i.useEffect(()=>{if(!r||!s)return;(async()=>{try{o(!0);const m=(s==null?void 0:s.token)||localStorage.getItem("token")||void 0,h=await y.get("/api/vendors/my-work",{token:m}),u=(h==null?void 0:h.data)||{};g(u.complaints||[]),d(u.stats||{open:0,"in-progress":0,completed:0,total:0})}catch(m){console.error("Failed to fetch vendor work:",m)}finally{o(!1)}})()},[r,s]);const p=()=>{};return r?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(j,{}),e.jsx("main",{className:"flex-1 bg-slate-100 py-10",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"My Vendor Tasks"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Open"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.open})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"In Progress"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:a["in-progress"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Completed"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.completed})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Assigned"}),e.jsx("div",{className:"text-2xl font-bold text-[#07164a]",children:a.total})]})]}),t&&e.jsx("div",{className:"text-center py-12 text-gray-600",children:"Loading your tasks..."}),!t&&n.length===0&&e.jsxs("div",{className:"bg-white rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-gray-500 mb-2",children:"No complaints assigned to you yet."}),e.jsx("div",{className:"text-sm text-gray-400",children:"You'll see your tasks here once they're assigned."})]}),!t&&n.length>0&&e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:n.map(x=>e.jsx(k,{c:x,onSelect:c,onAction:p,canAct:!0},x._id))})]})}),e.jsx(f,{}),l&&e.jsx(w,{complaint:l,onClose:()=>c(null),onUpdate:p})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(j,{}),e.jsx("main",{className:"flex-1 bg-slate-100 py-10",children:e.jsx("div",{className:"max-w-6xl mx-auto px-6",children:e.jsx("div",{className:"bg-rose-100 border border-rose-300 text-rose-800 px-4 py-3 rounded",children:"You need vendor role to access this page."})})}),e.jsx(f,{})]})}export{P as default};
