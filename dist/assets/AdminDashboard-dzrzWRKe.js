const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CCpieWfV.css","assets/index-DSpZquNv.css"])))=>i.map(i=>d[i]);
import{j as e,N as tt,F as st,_ as Ne}from"./index-BR_n0HI9.js";import{r,u as at}from"./react-core-Ljpx9oFu.js";import{a as m}from"./vendor-B9ygI19o.js";import{A as nt}from"./AnnouncementsList-C6bFi4Se.js";import{B as rt}from"./BookingLegend-gY-UJ59M.js";import{u as ot}from"./useBookingsStore-DH11w04p.js";import{P as it,R as lt}from"./ReceiptPreviewModal-CLyGuUEK.js";import{f as dt,s as ct,L as mt,a as xt}from"./LogFilters-D3X6PooW.js";import{P as pt,U as ht,A as ut,a as gt}from"./PaymentTrendChart-DMmueMg3.js";import"./api-B_kgTFai.js";import"./fileUtils-D5euisqX.js";function jt(c,L,u){const x=new Blob([u],{type:L}),p=URL.createObjectURL(x),l=document.createElement("a");l.href=p,l.download=c,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(p)}function ft({logs:c=[]}){const L=()=>{const x=["id","timestamp","user","action","ip","ref"],p=c.map(d=>{var N;return[d.id,d.ts,d.user,d.action,d.ip,((N=d==null?void 0:d.meta)==null?void 0:N.ref)||""]}),l=[x.join(","),...p.map(d=>d.map(N=>`"${String(N).replace(/"/g,'""')}"`).join(","))].join(`
`);jt(`audit_logs_${Date.now()}.csv`,"text/csv;charset=utf-8",l)},u=()=>{const x=window.open("","_blank");if(!x){alert("Pop-up blocked. Please allow pop-ups for this site.");return}const p=`
<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Audit Logs</title>
<style>
  body { font-family: Arial, sans-serif; padding: 16px; }
  h1 { font-size: 18px; margin-bottom: 12px; }
  table { width: 100%; border-collapse: collapse; font-size: 12px; }
  th, td { border: 1px solid #ccc; padding: 6px 8px; text-align: left; }
  th { background: #f3f4f6; }
</style>
</head>
<body>
  <h1>Audit Logs</h1>
  <table>
    <thead>
      <tr>
        <th>ID</th><th>Timestamp</th><th>User</th><th>Action</th><th>IP</th><th>Ref</th>
      </tr>
    </thead>
    <tbody>
      ${c.map(l=>{var d;return`
        <tr>
          <td>${S(l.id)}</td>
          <td>${S(l.ts)}</td>
          <td>${S(l.user)}</td>
          <td>${S(l.action)}</td>
          <td>${S(l.ip)}</td>
          <td>${S(((d=l==null?void 0:l.meta)==null?void 0:d.ref)||"")}</td>
        </tr>
      `}).join("")}
    </tbody>
  </table>
  <script>
    window.onload = function () { window.print(); };
  <\/script>
</body>
</html>`;x.document.open(),x.document.write(p),x.document.close()};return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:L,className:"px-3 py-2 rounded bg-white text-[#06164a] border border-[#06164a] text-xs",children:"Export CSV"}),e.jsx("button",{onClick:u,className:"px-3 py-2 rounded bg-[#06164a] text-white text-xs",children:"Export PDF"})]})}function S(c){return String(c).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Rt(){const[c,L]=r.useState(null),[u,x]=r.useState([]),[p,l]=r.useState([]),[d,N]=r.useState([]),[I,we]=r.useState(!1),[V,ke]=r.useState(!1),[Se,G]=r.useState(!0),[K,Le]=r.useState(""),[F,Ae]=r.useState(!1),[w,Me]=r.useState("all"),[k,Ce]=r.useState("pending"),[B,Re]=r.useState(""),[$,De]=r.useState(""),[g,_]=r.useState({open:!1,id:null,action:"approve"}),[Pe,Fe]=r.useState(0),[A,Be]=r.useState([]),[X,Y]=r.useState(!1),[U,M]=r.useState(""),[T,Z]=r.useState({open:!1,fileUrl:"",filename:""}),[W,$e]=r.useState("all"),[C,ee]=r.useState(null),[te,se]=r.useState(!1),[ae,ze]=r.useState([]),[H,ne]=r.useState([]),[O,re]=r.useState({from:null,to:null,user:"all",action:"all"}),[R,oe]=r.useState(""),[q,ie]=r.useState(1),J=10,y=at(),{listFacilities:Ee,bookings:Q,refresh:D,loading:le,error:de,approveBooking:Ie,rejectBooking:Ve}=ot();r.useEffect(()=>{const t=localStorage.getItem("user");if(t)try{const s=JSON.parse(t);L(s)}catch(s){console.error("Error parsing user data:",s)}(async()=>{await Promise.all([Ne(()=>Promise.resolve({}),__vite__mapDeps([0])),Ne(()=>Promise.resolve({}),__vite__mapDeps([1]))])})(),Ue(),z("resident"),z("vendor"),_e(),D({status:"pending",limit:50}),E(),ge(),Je()},[D]);const _e=async()=>{var t,a,s,n;try{const i={Authorization:`Bearer ${localStorage.getItem("token")}`},[h,j]=await Promise.all([m.get("/api/complaints?status=open&limit=1",{headers:i}),m.get("/api/complaints?status=in-progress&limit=1",{headers:i})]),f=((a=(t=h.data)==null?void 0:t.pagination)==null?void 0:a.total)||0,v=((n=(s=j.data)==null?void 0:s.pagination)==null?void 0:n.total)||0;Fe(f+v)}catch(o){console.warn("Failed to fetch active complaints count:",(o==null?void 0:o.message)||o)}},Ue=async()=>{var t,a;try{const s=localStorage.getItem("token"),n=await m.get("/api/admin/pending-users",{headers:{Authorization:`Bearer ${s}`}});n.data.success&&x(n.data.users),G(!1)}catch(s){console.error("Error fetching pending users:",s),Le(((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to load pending users"),G(!1)}},Te=async t=>{var a,s;try{const n=localStorage.getItem("token");(await m.put(`/api/admin/approve/${t}`,{},{headers:{Authorization:`Bearer ${n}`}})).data.success&&(x(u.filter(i=>i._id!==t)),alert("User approved successfully!"))}catch(n){console.error("Error approving user:",n),alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to approve user")}},We=async t=>{var a,s;if(confirm("Are you sure you want to reject this user?"))try{const n=localStorage.getItem("token");(await m.put(`/api/admin/reject/${t}`,{},{headers:{Authorization:`Bearer ${n}`}})).data.success&&(x(u.filter(i=>i._id!==t)),alert("User rejected successfully!"))}catch(n){console.error("Error rejecting user:",n),alert(((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to reject user")}},z=async(t,a=!1)=>{var s,n;try{const o=localStorage.getItem("token"),i=await m.get(`/api/admin/users/${t}`,{headers:{Authorization:`Bearer ${o}`}});i.data.success&&(t==="resident"?(l(i.data.users),a&&we(!I)):t==="vendor"&&(N(i.data.users),a&&ke(!V)))}catch(o){console.error(`Error fetching ${t}s:`,o),alert(((n=(s=o.response)==null?void 0:s.data)==null?void 0:n.message)||`Failed to load ${t}s`)}};r.useEffect(()=>{F&&D({status:k==="all"?void 0:k,facilityId:w==="all"?void 0:w,startDate:B||void 0,endDate:$||void 0})},[F,w,k,B,$,D]);const ce=Ee(),me=Object.fromEntries(ce.map(t=>[t.id,t.name])),He=Date.now(),xe=Q.filter(t=>["pending","approved"].includes(t.status)&&new Date(t.start).getTime()>=He).sort((t,a)=>new Date(t.start)-new Date(a.start)).slice(0,5),pe=(t,a)=>_({open:!0,id:t,action:a}),he=()=>_({open:!1,id:null,action:"approve"}),Oe=async t=>{g.id&&(g.action==="approve"?await Ie(g.id,t,c==null?void 0:c.id):await Ve(g.id,t,c==null?void 0:c.id),he(),D({status:k==="all"?void 0:k,facilityId:w==="all"?void 0:w,startDate:B||void 0,endDate:$||void 0}))},ue={approved:"bg-emerald-50 text-emerald-700",pending:"bg-amber-50 text-amber-700",rejected:"bg-rose-50 text-rose-700",cancelled:"bg-slate-100 text-slate-600"},qe=()=>g.open?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 w-full max-w-md",children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:g.action==="approve"?"Approve Booking":"Reject Booking"}),e.jsx("textarea",{className:"w-full border rounded p-2 mb-3 text-sm",rows:3,placeholder:"Optional reason (visible to resident)",onChange:t=>_(a=>({...a,reason:t.target.value})),value:g.reason||""}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:he,className:"px-3 py-2 rounded border text-sm",children:"Cancel"}),e.jsx("button",{onClick:()=>Oe(g.reason||""),className:`px-3 py-2 rounded text-sm text-white ${g.action==="approve"?"bg-emerald-600":"bg-rose-600"}`,children:g.action==="approve"?"Approve":"Reject"})]})]})}):null,E=async()=>{var t,a;Y(!0),M("");try{const s=localStorage.getItem("token"),n=await m.get("/api/payments/receipts/pending",{headers:{Authorization:`Bearer ${s}`}});if(n.data.success){const o=n.data.data.map(i=>{var h,j,f,v;return{id:i._id,userName:((h=i.residentId)==null?void 0:h.name)||"Unknown",flat:((j=i.residentId)==null?void 0:j.houseNumber)||"N/A",charge:((v=(f=i.dueId)==null?void 0:f.chargeId)==null?void 0:v.title)||"Payment",amount:i.amount,paidAt:i.transactionDate,receiptUrl:i.receiptImageUrl,status:i.status,remarks:i.remarks}});Be(o)}}catch(s){console.error("Error fetching pending payments:",s),M(((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to load payment requests")}finally{Y(!1)}},Je=async()=>{try{const t=localStorage.getItem("token"),a=await m.get("/api/audit/logs?limit=100",{headers:{Authorization:`Bearer ${t}`}});if(a.data.success){const s=a.data.data.logs.map((n,o)=>({id:n._id||`log-${o}`,timestamp:n.createdAt,user:n.userName,action:n.action,ip:n.ipAddress,ref:n.resourceId||"-"}));ze(s)}}catch(t){console.error("Error fetching audit logs:",t)}},ge=async()=>{var t;se(!0);try{const s={Authorization:`Bearer ${localStorage.getItem("token")}`},[n,o,i]=await Promise.all([m.get("/api/reports/payment-summary",{headers:s}),m.get("/api/reports/activity",{headers:s}),m.get("/api/reports/payment-trend?period=monthly",{headers:s})]),h=n.data.success?n.data.data:{},j=o.data.success?o.data.data:{},f=i.data.success?i.data.data:{},v=(h.paymentsVerified||0)+(h.paymentsRejected||0),Ye=v>0?(h.paymentsVerified/v*100).toFixed(2):0,je=j.totalUsers||0,fe=(j.activeResidents||0)+(j.activeVendors||0),Ze=je>0?(fe/je*100).toFixed(2):0,ye=[];for(let P=13;P>=0;P--){const b=new Date;b.setDate(b.getDate()-P),ye.push({date:b.toLocaleDateString(),logins:Math.floor(Math.random()*20),bookings:Math.floor(Math.random()*10),payments:Math.floor(Math.random()*8)})}const et=((t=f.labels)==null?void 0:t.map((P,b)=>{var ve,be;return{month:P,amount:((ve=f.collected)==null?void 0:ve[b])||0,previous:b>0&&((be=f.collected)==null?void 0:be[b-1])||0}}))||[];ee({payments:{totalCollected:h.totalCollected||0,pendingPayments:h.duesPending||0,overduePayments:h.duesOverdue||0,successRate:parseFloat(Ye)},users:{totalUsers:j.totalUsers||0,activeUsers:fe,newRegistrations:j.pendingApprovals||0,activityRate:parseFloat(Ze)},activity:ye,paymentTrend:et})}catch(a){console.error("Error fetching reports data:",a),ee({payments:{totalCollected:0,pendingPayments:0,overduePayments:0,successRate:0},users:{totalUsers:0,activeUsers:0,newRegistrations:0,activityRate:0},activity:[],paymentTrend:[]})}finally{se(!1)}},Qe=async(t,a="")=>{var s,n;try{const o=localStorage.getItem("token");await m.put(`/api/payments/verification/verify/${t}`,{},{headers:{Authorization:`Bearer ${o}`}}),E()}catch(o){console.error("Error approving payment:",o),M(((n=(s=o.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to approve payment")}},Ge=async(t,a="")=>{var s,n;if(!a||!a.trim()){M("Rejection reason is required");return}try{const o=localStorage.getItem("token");await m.put(`/api/payments/verification/reject/${t}`,{rejectionReason:a},{headers:{Authorization:`Bearer ${o}`}}),E()}catch(o){console.error("Error rejecting payment:",o),M(((n=(s=o.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to reject payment")}},Ke=(t,a="receipt")=>Z({open:!0,fileUrl:t,filename:a}),Xe=()=>Z({open:!1,fileUrl:"",filename:""});return r.useEffect(()=>{let t=dt(ae,O);R.trim()&&(t=ct(t,R.trim())),ne(t),ie(1)},[ae,O,R]),e.jsxs("div",{className:"min-h-screen flex flex-col bg-ng-light",children:[e.jsx(tt,{}),e.jsx("main",{className:"flex-grow pt-40 pb-16 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-ng-blue to-ng-accent rounded-2xl shadow-lg p-8 mb-8 text-white",children:[e.jsx("h1",{className:"text-4xl font-normal mb-2",style:{fontFamily:"'DM Serif Display', serif"},children:"Admin Dashboard"}),e.jsxs("p",{className:"text-lg opacity-90",style:{fontFamily:"Poppins, sans-serif"},children:["Welcome back, ",(c==null?void 0:c.name)||"Admin","! Manage your housing society."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow border-l-4 border-blue-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Total Residents"}),e.jsx("div",{className:"text-3xl font-bold text-ng-blue",children:p.filter(t=>t.status==="approved").length})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),e.jsx("p",{className:"text-sm text-green-600",children:"↑ All approved residents"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow border-l-4 border-orange-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Pending Approvals"}),e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:u.length})]}),e.jsx("div",{className:"bg-orange-100 p-3 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsx("button",{onClick:()=>{const t=document.querySelector("[data-pending-users]");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},className:"text-sm text-orange-600 hover:underline",children:"Review now →"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow border-l-4 border-red-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Active Complaints"}),e.jsx("div",{className:"text-3xl font-bold text-red-600",children:Pe})]}),e.jsx("div",{className:"bg-red-100 p-3 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})]}),e.jsx("button",{onClick:()=>y("/complaints"),className:"text-sm text-red-600 hover:underline",children:"View details →"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow border-l-4 border-green-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Monthly Revenue"}),e.jsx("div",{className:"text-3xl font-bold text-green-600",children:"$0"})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Coming soon"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue",style:{fontFamily:"'DM Serif Display', serif"},children:"User Management"}),e.jsx("svg",{className:"w-6 h-6 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"w-full px-4 py-3 rounded-lg bg-blue-50","data-pending-users":!0,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("span",{className:"text-ng-blue font-medium",children:["Pending Registrations (",u.length,")"]})}),Se?e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading..."}):K?e.jsx("p",{className:"text-red-600 text-sm",children:K}):u.length===0?e.jsx("p",{className:"text-gray-600 text-sm",children:"No pending registrations"}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:u.map(t=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.email}),e.jsx("p",{className:"text-sm text-gray-600",children:t.phone})]}),e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",children:t.role})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>Te(t._id),className:"flex-1 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:"Approve"}),e.jsx("button",{onClick:()=>We(t._id),className:"flex-1 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"Reject"})]})]},t._id))})]}),e.jsxs("div",{className:"w-full rounded-lg bg-gray-50",children:[e.jsxs("button",{onClick:()=>z("resident",!0),className:"w-full text-left px-4 py-3 hover:bg-gray-100 transition-colors flex items-center justify-between rounded-lg",children:[e.jsxs("span",{className:"text-gray-700 font-medium",children:["All Residents (",p.length,")"]}),e.jsx("svg",{className:`w-5 h-5 text-gray-700 transition-transform ${I?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),I&&e.jsx("div",{className:"px-4 pb-4 space-y-2 max-h-80 overflow-y-auto",children:p.length===0?e.jsx("p",{className:"text-gray-600 text-sm py-2",children:"No residents found"}):p.map(t=>e.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.email}),e.jsx("p",{className:"text-sm text-gray-600",children:t.phone||"No phone"})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="approved"?"bg-green-100 text-green-800":t.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status})]})},t._id))})]}),e.jsxs("div",{className:"w-full rounded-lg bg-gray-50",children:[e.jsxs("button",{onClick:()=>z("vendor",!0),className:"w-full text-left px-4 py-3 hover:bg-gray-100 transition-colors flex items-center justify-between rounded-lg",children:[e.jsxs("span",{className:"text-gray-700 font-medium",children:["All Vendors (",d.length,")"]}),e.jsx("svg",{className:`w-5 h-5 text-gray-700 transition-transform ${V?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),V&&e.jsx("div",{className:"px-4 pb-4 space-y-2 max-h-80 overflow-y-auto",children:d.length===0?e.jsx("p",{className:"text-gray-600 text-sm py-2",children:"No vendors found"}):d.map(t=>e.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.email}),e.jsx("p",{className:"text-sm text-gray-600",children:t.phone||"No phone"})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="approved"?"bg-green-100 text-green-800":t.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status})]})},t._id))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue",style:{fontFamily:"'DM Serif Display', serif"},children:"Announcements"}),e.jsx("svg",{className:"w-6 h-6 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>y("/announcements"),className:"bg-ng-blue text-white px-4 py-2 rounded-lg hover:bg-ng-accent transition-colors",children:"Manage Announcements"}),e.jsx("button",{onClick:()=>y("/announcements"),className:"text-ng-blue hover:underline",children:"View all →"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:e.jsx(nt,{limit:5})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mt-6",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue mb-6",style:{fontFamily:"'DM Serif Display', serif"},children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:()=>y("/complaints"),className:"p-4 rounded-lg border-2 border-gray-200 hover:border-ng-blue hover:bg-blue-50 transition-all text-center",children:[e.jsxs("svg",{className:"w-8 h-8 mx-auto mb-2 text-ng-blue",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.25 12c0-4.28 3.47-7.75 7.75-7.75h4c4.28 0 7.75 3.47 7.75 7.75s-3.47 7.75-7.75 7.75H10l-4.5 2.25.75-3.75A7.724 7.724 0 012.25 12z"})]}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Manage Complaints"})]}),e.jsxs("button",{onClick:()=>y("/payments"),className:"p-4 rounded-lg border-2 border-gray-200 hover:border-ng-blue hover:bg-blue-50 transition-all text-center",children:[e.jsx("svg",{className:"w-8 h-8 mx-auto mb-2 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"View Payments"})]}),e.jsxs("button",{onClick:()=>y("/facility"),className:"p-4 rounded-lg border-2 border-gray-200 hover:border-ng-blue hover:bg-blue-50 transition-all text-center",children:[e.jsxs("svg",{className:"w-8 h-8 mx-auto mb-2 text-ng-blue",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6.75 3v2.25M17.25 3v2.25M3 8.25h18M4.5 7.5h15a1.5 1.5 0 011.5 1.5v10.5A1.5 1.5 0 0119.5 21H4.5A1.5 1.5 0 013 19.5V9A1.5 1.5 0 014.5 7.5z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.25 12h3M12.75 12h3M8.25 15.75h3M12.75 15.75h3"})]}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Facility Bookings"})]}),e.jsxs("button",{className:"p-4 rounded-lg border-2 border-gray-200 hover:border-ng-blue hover:bg-blue-50 transition-all text-center",children:[e.jsx("svg",{className:"w-8 h-8 mx-auto mb-2 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 012 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"View Reports"})]})]})]}),e.jsxs("section",{id:"admin-bookings",className:"bg-white rounded-xl shadow-lg p-6 mt-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue",style:{fontFamily:"'DM Serif Display', serif"},children:"Bookings Management"}),e.jsx("svg",{className:"w-6 h-6 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"w-full px-4 py-3 rounded-lg bg-blue-50",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("span",{className:"text-ng-blue font-medium",children:"Upcoming Bookings (next 5)"})}),e.jsxs("div",{className:"space-y-3 max-h-56 overflow-y-auto",children:[xe.length===0&&e.jsx("p",{className:"text-sm text-gray-600",children:"No upcoming bookings"}),xe.map(t=>e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm text-sm flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.purpose||t.title||"Booking"}),e.jsxs("p",{className:"text-gray-600",children:[me[t.facilityId]||t.facilityId," • ",new Date(t.start).toLocaleDateString()," ",new Date(t.start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ue[t.status]||"bg-slate-100 text-slate-700"}`,children:t.status})]},t.id))]})]}),e.jsxs("div",{className:"w-full rounded-lg bg-gray-50",children:[e.jsxs("button",{onClick:()=>Ae(t=>!t),className:"w-full text-left px-4 py-3 hover:bg-gray-100 transition-colors flex items-center justify-between rounded-lg",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"All Bookings"}),e.jsx("svg",{className:`w-5 h-5 text-gray-700 transition-transform ${F?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),F&&e.jsxs("div",{className:"px-4 pb-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("select",{className:"bg-[#07164a] text-white rounded px-3 py-2 text-sm",value:w,onChange:t=>Me(t.target.value),children:[e.jsx("option",{value:"all",children:"Facility: All"}),ce.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{className:"bg-[#07164a] text-white rounded px-3 py-2 text-sm",value:k,onChange:t=>Ce(t.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"all",children:"All Statuses"})]}),e.jsx("input",{type:"date",className:"bg-[#07164a] text-white rounded px-3 py-2 text-sm",value:B,onChange:t=>Re(t.target.value)}),e.jsx("input",{type:"date",className:"bg-[#07164a] text-white rounded px-3 py-2 text-sm",value:$,onChange:t=>De(t.target.value)}),e.jsx("div",{className:"ml-auto",children:e.jsx(rt,{})})]}),le&&e.jsx("div",{className:"text-sm",children:"Loading bookings…"}),de&&e.jsx("div",{className:"text-sm text-rose-600",children:de}),e.jsx("div",{className:"overflow-x-auto bg-white rounded-md shadow",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left bg-slate-50",children:[e.jsx("th",{className:"px-4 py-2",children:"Title"}),e.jsx("th",{className:"px-4 py-2",children:"Facility"}),e.jsx("th",{className:"px-4 py-2",children:"When"}),e.jsx("th",{className:"px-4 py-2",children:"Status"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsxs("tbody",{children:[Q.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2",children:t.purpose||t.title||"Booking"}),e.jsx("td",{className:"px-4 py-2",children:me[t.facilityId]||t.facilityId}),e.jsxs("td",{className:"px-4 py-2",children:[new Date(t.start).toLocaleDateString(),e.jsx("br",{}),new Date(t.start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",new Date(t.end).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),e.jsxs("td",{className:"px-4 py-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ue[t.status]||"bg-blue-50 text-blue-700"}`,children:t.status}),t.reviewReason&&e.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5 truncate max-w-[120px]",children:t.reviewReason})]}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>pe(t.id,"approve"),disabled:t.status!=="pending",className:"text-xs px-3 py-1 rounded bg-emerald-600 text-white disabled:opacity-40",children:"Approve"}),e.jsx("button",{onClick:()=>pe(t.id,"reject"),disabled:t.status!=="pending",className:"text-xs px-3 py-1 rounded bg-rose-600 text-white disabled:opacity-40",children:"Reject"})]})})]},t.id)),Q.length===0&&!le&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-gray-500",children:"No bookings found."})})]})]})})]})]})]})]}),e.jsx("div",{className:"my-6"}),e.jsxs("section",{id:"admin-payments",className:"bg-white rounded-xl shadow-lg p-6 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue",style:{fontFamily:"'DM Serif Display', serif"},children:"Payment Management"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:W,onChange:t=>$e(t.target.value),className:"px-3 py-2 rounded border border-gray-300 text-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"verified",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsx("button",{onClick:E,className:"px-3 py-2 rounded bg-ng-blue text-white text-sm hover:bg-ng-accent",children:"Refresh"})]})]}),e.jsxs("div",{className:"mb-4 flex flex-wrap gap-4",children:[e.jsxs("div",{className:"px-4 py-3 rounded-lg bg-blue-50 text-sm",children:["Pending: ",A.filter(t=>t.status==="pending").length]}),e.jsxs("div",{className:"px-4 py-3 rounded-lg bg-green-50 text-sm",children:["Approved: ",A.filter(t=>t.status==="approved").length]}),e.jsxs("div",{className:"px-4 py-3 rounded-lg bg-rose-50 text-sm",children:["Rejected: ",A.filter(t=>t.status==="rejected").length]})]}),X&&e.jsx("div",{className:"rounded-md border border-blue-200 bg-blue-50 text-blue-700 px-4 py-3 mb-4 text-sm",children:"Loading payment requests…"}),U&&e.jsx("div",{className:"rounded-md border border-red-300 bg-red-100 text-red-700 px-4 py-3 mb-4 text-sm",children:U}),!X&&A.length===0&&!U&&e.jsx("div",{className:"rounded-md border border-green-300 bg-green-100 text-green-700 px-4 py-3 text-sm",children:"No payment requests."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:A.filter(t=>W==="all"||t.status===W).sort((t,a)=>{const s={pending:0,verified:1,rejected:2};return(s[t.status]||3)-(s[a.status]||3)}).map(t=>e.jsx(it,{item:t,onApprove:Qe,onReject:Ge,onViewReceipt:Ke},t.id))})]}),e.jsxs("section",{id:"admin-audit-logs",className:"bg-white rounded-xl shadow-lg p-6 mt-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue",style:{fontFamily:"'DM Serif Display', serif"},children:"Audit Logs"}),e.jsx(ft,{logs:H})]}),e.jsx(mt,{filters:O,setFilters:re,onApply:()=>{},onClear:()=>{re({from:null,to:null,user:"all",action:"all"}),oe("")},search:R,setSearch:oe}),e.jsx(xt,{logs:H.slice((q-1)*J,q*J),highlight:R,page:q,totalPages:Math.max(1,Math.ceil(H.length/J)),setPage:ie,sortCallback:t=>ne(t)})]}),e.jsxs("section",{id:"admin-reports",className:"bg-white rounded-xl shadow-lg p-6 mt-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue",style:{fontFamily:"'DM Serif Display', serif"},children:"Reports Snapshot"}),e.jsx("button",{onClick:ge,className:"px-3 py-2 rounded bg-ng-blue text-white text-sm",children:"Refresh"})]}),te&&e.jsx("div",{className:"text-sm",children:"Loading metrics…"}),!te&&C&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx(pt,{metrics:C.payments}),e.jsx(ht,{metrics:C.users}),e.jsx(ut,{activity:C.activity})]}),e.jsx(gt,{trend:C.paymentTrend})]})]}),e.jsx("section",{id:"admin-complaints",className:"bg-white rounded-xl shadow-lg p-6 mt-10",children:e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue",style:{fontFamily:"'DM Serif Display', serif"},children:"Complaints Management"}),e.jsx("button",{onClick:()=>y("/complaints"),className:"px-3 py-2 rounded bg-ng-blue text-white text-sm hover:bg-ng-accent",children:"View All Complaints"})]})})]})}),e.jsx(st,{}),e.jsx(qe,{}),e.jsx(lt,{isOpen:T.open,fileUrl:T.fileUrl,filename:T.filename,onClose:Xe})]})}export{Rt as default};
