const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CCpieWfV.css","assets/index-DSpZquNv.css"])))=>i.map(i=>d[i]);
import{j as e,N as _,F as T,_ as j}from"./index-BR_n0HI9.js";import{r as a}from"./react-core-Ljpx9oFu.js";import{a as f}from"./vendor-B9ygI19o.js";function D(){const[x,h]=a.useState(1),[n,N]=a.useState(""),[m,v]=a.useState(""),[p,P]=a.useState(""),[g,S]=a.useState(""),[i,d]=a.useState(!1),[y,t]=a.useState(""),[b,c]=a.useState("");a.useEffect(()=>{(async()=>{await Promise.all([j(()=>Promise.resolve({}),__vite__mapDeps([0])),j(()=>Promise.resolve({}),__vite__mapDeps([1]))])})()},[]);const w=async s=>{var r,o;if(s.preventDefault(),t(""),c(""),!n)return t("Please enter your email");try{d(!0),await f.post("/api/auth/forgot-password",{email:n}),c("If an account exists, an OTP has been sent to your email."),h(2)}catch(l){t(((o=(r=l.response)==null?void 0:r.data)==null?void 0:o.message)||"Failed to send OTP")}finally{d(!1)}},E=async s=>{var r,o,l;if(s.preventDefault(),t(""),c(""),!m)return t("Enter the OTP sent to your email");try{d(!0),(r=(await f.post("/api/auth/verify-otp",{email:n,otp:m})).data)!=null&&r.success&&(c("OTP verified. You can set a new password."),h(3))}catch(u){t(((l=(o=u.response)==null?void 0:o.data)==null?void 0:l.message)||"Invalid or expired OTP")}finally{d(!1)}},O=async s=>{var r,o,l;if(s.preventDefault(),t(""),c(""),!p||!g)return t("Enter and confirm the new password");if(p!==g)return t("Passwords do not match");try{d(!0),(r=(await f.post("/api/auth/reset-password",{email:n,otp:m,newPassword:p})).data)!=null&&r.success&&c("Password updated. You can now log in.")}catch(u){t(((l=(o=u.response)==null?void 0:o.data)==null?void 0:l.message)||"Failed to reset password")}finally{d(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-ng-light",children:[e.jsx(_,{}),e.jsx("main",{className:"flex-grow pt-40 pb-16 px-6",children:e.jsxs("div",{className:"max-w-lg mx-auto w-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-ng-blue to-ng-accent rounded-2xl shadow-lg p-8 text-white mb-6",children:[e.jsx("h1",{className:"text-3xl font-normal",style:{fontFamily:"'DM Serif Display', serif"},children:"Forgot Password"}),e.jsx("p",{className:"opacity-90",style:{fontFamily:"Poppins, sans-serif"},children:"Reset your password securely using a one-time code sent to your email."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-6 space-y-4",children:[y&&e.jsx("div",{className:"p-3 rounded bg-red-50 text-red-700 text-sm",children:y}),b&&e.jsx("div",{className:"p-3 rounded bg-green-50 text-green-700 text-sm",children:b}),x===1&&e.jsxs("form",{onSubmit:w,className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",value:n,onChange:s=>N(s.target.value),className:"w-full border rounded-lg px-3 py-2",placeholder:"you@example.com",required:!0}),e.jsx("button",{type:"submit",disabled:i,className:"mt-2 px-4 py-2 rounded-lg bg-ng-blue text-white hover:bg-ng-accent disabled:opacity-60",children:i?"Sending...":"Send OTP"})]}),x===2&&e.jsxs("form",{onSubmit:E,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"We sent an OTP to"}),e.jsx("div",{className:"text-gray-800 font-medium",children:n})]}),e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enter OTP"}),e.jsx("input",{type:"text",value:m,onChange:s=>v(s.target.value),className:"w-full border rounded-lg px-3 py-2 tracking-widest",placeholder:"123456",required:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 rounded-lg bg-ng-blue text-white hover:bg-ng-accent disabled:opacity-60",children:i?"Verifying...":"Verify OTP"}),e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 rounded-lg border",children:"Resend"})]})]}),x===3&&e.jsxs("form",{onSubmit:O,className:"space-y-3",children:[e.jsxs("div",{className:"text-gray-700 text-sm",children:["Email: ",e.jsx("span",{className:"font-medium",children:n})]}),e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),e.jsx("input",{type:"password",value:p,onChange:s=>P(s.target.value),className:"w-full border rounded-lg px-3 py-2",placeholder:"At least 6 characters",required:!0}),e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),e.jsx("input",{type:"password",value:g,onChange:s=>S(s.target.value),className:"w-full border rounded-lg px-3 py-2",required:!0}),e.jsx("button",{type:"submit",disabled:i,className:"mt-2 px-4 py-2 rounded-lg bg-ng-blue text-white hover:bg-ng-accent disabled:opacity-60",children:i?"Saving...":"Set New Password"})]})]})]})}),e.jsx(T,{})]})}export{D as default};
