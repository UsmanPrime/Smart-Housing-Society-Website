const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CCpieWfV.css","assets/index-DSpZquNv.css"])))=>i.map(i=>d[i]);
import{j as e,N as L,F as B,_ as k}from"./index-DJsc_qVc.js";import{r as x,u as D}from"./react-core-Ljpx9oFu.js";import{A as M}from"./AnnouncementsList-iTW8_Eje.js";import{u as C}from"./useBookingsStore-BUsMa_0t.js";import{B as _}from"./BookingLegend-2wbWRWJ3.js";import{u as V}from"./useAuth-4QJvpUN4.js";import{u as S}from"./useComplaints-BOdCs5Ff.js";import"./vendor-B9ygI19o.js";const A=s=>s==="approved"?"bg-emerald-600":s==="pending"?"bg-amber-600":s==="rejected"?"bg-rose-600":s==="cancelled"?"bg-slate-500":"bg-blue-600";function E({booking:s,onClose:a,facilityName:m}){var o,d;const{isAdmin:h,user:n}=V(),{deleteBooking:v,approveBooking:w,rejectBooking:u}=C(),g=x.useRef(null);x.useEffect(()=>{const l=document.body.style.overflow;document.body.style.overflow="hidden";const f=y=>y.key==="Escape"&&a();return document.addEventListener("keydown",f),()=>{document.body.style.overflow=l,document.removeEventListener("keydown",f)}},[a]);const p=(h||(n==null?void 0:n.id)===(((o=s.userId)==null?void 0:o._id)||s.userId))&&s.status!=="cancelled",j=async()=>{await w(s._id||s.id),a()},N=async()=>{const l=prompt("Enter rejection reason:");l&&(await u(s._id||s.id,l),a())},r=async()=>{confirm("Are you sure you want to cancel this booking?")&&(await v(s._id||s.id),a())};return e.jsx("div",{className:"fixed inset-0 z-[70] bg-black/60 flex items-center justify-center p-4",onMouseDown:l=>l.target===l.currentTarget&&a(),children:e.jsxs("div",{ref:g,className:"bg-white rounded-xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"bg-[#07164a] text-white px-5 py-3 flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold",children:"Booking Details"}),e.jsx("button",{onClick:a,"aria-label":"Close",children:"✕"})]}),e.jsxs("div",{className:"p-5 space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.purpose||"Booking"}),e.jsx("div",{className:"text-sm text-gray-700",children:m||((d=s.facilityId)==null?void 0:d.name)}),e.jsxs("div",{className:"text-sm text-gray-700",children:[new Date(s.startTime||s.start).toLocaleString()," - ",new Date(s.endTime||s.end).toLocaleTimeString()]}),e.jsxs("div",{className:"text-sm",children:["Status: ",e.jsx("span",{className:`text-white text-xs px-2 py-0.5 rounded ${A(s.status)}`,children:s.status})]}),s.notes&&e.jsxs("div",{className:"text-sm text-gray-700",children:["Notes: ",s.notes]}),s.attendees&&e.jsxs("div",{className:"text-sm text-gray-700",children:["Attendees: ",s.attendees]}),s.rejectionReason&&e.jsxs("div",{className:"text-sm text-rose-600",children:["Rejection Reason: ",s.rejectionReason]}),h&&s.status==="pending"&&e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:j,className:"text-xs px-3 py-1 rounded bg-emerald-600 text-white",children:"Approve"}),e.jsx("button",{onClick:N,className:"text-xs px-3 py-1 rounded bg-rose-600 text-white",children:"Reject"})]}),p&&e.jsx("button",{onClick:r,className:"text-xs px-3 py-1 rounded border text-rose-700 border-rose-300",children:"Cancel Booking"}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx("button",{onClick:a,className:"text-xs px-3 py-1 rounded border",children:"Close"})})]})]})})}function $(){const[s,a]=x.useState(null),[m,h]=x.useState(null),n=D(),{listMyBookings:v,listFacilities:w,fetchBookings:u,loading:g,error:p}=C(),{fetchComplaints:j,filterComplaints:N}=S();x.useEffect(()=>{const t=localStorage.getItem("user");if(t)try{const i=JSON.parse(t);a(i)}catch(i){console.error("Error parsing user data:",i)}(async()=>{await Promise.all([k(()=>Promise.resolve({}),__vite__mapDeps([0])),k(()=>Promise.resolve({}),__vite__mapDeps([1]))])})()},[]),x.useEffect(()=>{u(),j()},[u,j]);const r=v((s==null?void 0:s.id)||""),o=N("my"),d=Object.fromEntries(w().map(t=>[t._id||t.id,t.name])),l=Date.now(),f=r.filter(t=>!["cancelled","rejected"].includes(t.status)&&new Date(t.endTime||t.end).getTime()>=l).length,y=o.filter(t=>!["resolved","closed"].includes(t.status)).length,b=t=>t==="approved"?"text-emerald-600":t==="pending"?"text-amber-600":t==="rejected"?"text-rose-600":t==="cancelled"?"text-slate-500":"text-blue-600";return e.jsxs("div",{className:"min-h-screen flex flex-col bg-ng-light",children:[e.jsx(L,{}),e.jsx("main",{className:"flex-grow pt-40 pb-16 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-ng-blue to-ng-accent rounded-2xl shadow-lg p-8 mb-8 text-white",children:[e.jsx("h1",{className:"text-4xl font-normal mb-2",style:{fontFamily:"'DM Serif Display', serif"},children:"Resident Dashboard"}),e.jsxs("p",{className:"text-lg opacity-90",style:{fontFamily:"Poppins, sans-serif"},children:["Welcome, ",(s==null?void 0:s.name)||"Resident","!"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue",children:"My Profile"}),e.jsx("svg",{className:"w-8 h-8 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})]}),e.jsxs("p",{className:"text-gray-600 mb-2",children:["Email: ",s==null?void 0:s.email]}),e.jsxs("p",{className:"text-gray-600 mb-2",children:["Role: ",s==null?void 0:s.role]}),e.jsx("button",{onClick:()=>n("/profile"),className:"mt-4 bg-ng-blue text-white px-4 py-2 rounded-lg hover:bg-ng-accent transition-colors w-full",children:"Edit Profile"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue",children:"My Complaints"}),e.jsx("svg",{className:"w-8 h-8 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})]}),e.jsx("div",{className:"text-3xl font-bold text-ng-blue mb-2",children:y}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Active complaints"}),e.jsx("button",{onClick:()=>n("/complaints"),className:"bg-ng-blue text-white px-4 py-2 rounded-lg hover:bg-ng-accent transition-colors w-full",children:"View Complaints"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue",children:"Payments"}),e.jsx("svg",{className:"w-8 h-8 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})]}),e.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"$0.00"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Current dues (Coming soon)"}),e.jsx("button",{onClick:()=>n("/payments"),className:"bg-ng-blue text-white px-4 py-2 rounded-lg hover:bg-ng-accent transition-colors w-full",children:"View Payments"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue",children:"Facility Booking"}),e.jsx("svg",{className:"w-8 h-8 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]}),e.jsx("div",{className:"text-3xl font-bold text-ng-blue mb-1",children:f}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Active bookings"}),e.jsx("div",{className:"mt-1 mb-3",children:e.jsx(_,{})}),e.jsxs("div",{className:"mb-4 max-h-60 overflow-y-auto pr-1",children:[g&&e.jsx("div",{className:"text-sm",children:"Loading…"}),p&&e.jsx("div",{className:"text-sm text-rose-600",children:p}),e.jsxs("ul",{className:"space-y-2",children:[r.map(t=>{var c,i;return e.jsxs("li",{className:"rounded-md px-4 py-3 flex flex-col md:flex-row md:items-center md:justify-between gap-2 border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.purpose||t.title||"Booking"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[d[((c=t.facilityId)==null?void 0:c._id)||t.facilityId]||((i=t.facilityId)==null?void 0:i.name)||"Unknown"," • ",new Date(t.startTime||t.start).toLocaleDateString()," ",new Date(t.startTime||t.start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",new Date(t.endTime||t.end).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-xs font-medium ${b(t.status)}`,children:t.status}),e.jsx("button",{onClick:()=>h(t),className:"text-xs px-3 py-1 rounded bg-ng-blue text-white",children:"Details"})]})]},t._id||t.id)}),r.length===0&&!g&&e.jsx("li",{className:"text-sm text-gray-600",children:"No bookings yet."})]})]}),e.jsx("button",{onClick:()=>n("/facility"),className:"mt-auto bg-ng-blue text-white px-4 py-2 rounded-lg hover:bg-ng-accent transition-colors w-full",children:"Book Facility"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue",children:"Announcements"}),e.jsx("svg",{className:"w-8 h-8 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})})]}),e.jsx("div",{className:"mb-4 max-h-60 overflow-y-auto",children:e.jsx(M,{limit:3})}),e.jsx("button",{onClick:()=>n("/announcements"),className:"bg-ng-blue text-white px-4 py-2 rounded-lg hover:bg-ng-accent transition-colors w-full",children:"View All"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue",children:"Contact Support"}),e.jsx("svg",{className:"w-8 h-8 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Need help? Get in touch with us"}),e.jsx("button",{onClick:()=>n("/"),className:"bg-ng-blue text-white px-4 py-2 rounded-lg hover:bg-ng-accent transition-colors w-full mt-auto",children:"Contact Us"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 mt-8",children:[e.jsx("h2",{className:"text-2xl font-normal text-ng-blue mb-6",style:{fontFamily:"'DM Serif Display', serif"},children:"Recent Activity"}),e.jsxs("div",{className:"space-y-4",children:[r.slice(0,3).map(t=>{var c,i;return e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-10 h-10 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.purpose||t.title||"Facility Booking"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[d[((c=t.facilityId)==null?void 0:c._id)||t.facilityId]||((i=t.facilityId)==null?void 0:i.name)||"Unknown"," • ",new Date(t.startTime||t.start).toLocaleDateString()]})]}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${b(t.status)}`,children:t.status})]},t._id)}),o.slice(0,3).map(t=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-10 h-10 text-ng-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.category," • ",new Date(t.createdAt).toLocaleDateString()]})]}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${t.status==="resolved"?"text-emerald-600 bg-emerald-50":t.status==="in-progress"?"text-blue-600 bg-blue-50":t.status==="pending"?"text-amber-600 bg-amber-50":"text-gray-600 bg-gray-50"}`,children:t.status})]},t._id)),r.length===0&&o.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg",children:"No recent activity"})]})]})]})]})}),e.jsx(B,{}),m&&e.jsx(E,{booking:m,facilityName:d[m.facilityId],onClose:()=>h(null)})]})}export{$ as default};
