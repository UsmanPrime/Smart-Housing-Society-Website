import{j as e,N as S,F as D}from"./index-BR_n0HI9.js";import{r as n}from"./react-core-Ljpx9oFu.js";import{u as C}from"./useAuth-4QJvpUN4.js";import{u as F}from"./useBookingsStore-DH11w04p.js";import{c as E,a as B,r as M,b as q,d as $,e as A}from"./book-CEM827Ui.js";import"./vendor-B9ygI19o.js";import"./api-B_kgTFai.js";const R="/assets/facility-B3ZG-cWW.png",O="/assets/facilityHOME-DIj4k6nM.jpeg";function L(){var w;const{user:c}=C(),{listFacilities:f,createBooking:b,loading:o,error:h,fetchFacilities:l}=F(),i=f(),r=n.useMemo(()=>new Date().toISOString().slice(0,10),[]),[s,d]=n.useState({facilityId:((w=i[0])==null?void 0:w._id)||"",title:"",date:r,startTime:"10:00",endTime:"12:00",note:""}),[a,g]=n.useState({}),[y,j]=n.useState([]),[v,N]=n.useState(""),m=(t,x)=>d(p=>({...p,[t]:x})),T=()=>{const t={};return s.facilityId||(t.facilityId="Select a facility"),(!s.title||s.title.trim().length<3)&&(t.title="Min 3 characters"),s.date||(t.date="Date is required"),s.startTime||(t.startTime="Start time required"),s.endTime||(t.endTime="End time required"),s.startTime&&s.endTime&&s.endTime<=s.startTime&&(t.endTime="End must be after start"),g(t),Object.keys(t).length===0},k=async t=>{if(t.preventDefault(),N(""),j([]),g({}),!T())return;const x=`${s.date}T${s.startTime}:00`,p=`${s.date}T${s.endTime}:00`,u=await b({facilityId:s.facilityId,startTime:x,endTime:p,purpose:s.title,notes:s.note});if(!u.ok){u.conflicts&&j(u.conflicts),u.error&&g({general:u.error});return}N("Booking request submitted (pending approval)."),d(I=>({...I,title:"",note:""}))};return n.useEffect(()=>{(!s.facilityId||!i.find(t=>t._id===s.facilityId))&&d(t=>{var x;return{...t,facilityId:((x=i[0])==null?void 0:x._id)||""}})},[i]),c?c.role!=="resident"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-4xl md:text-4xl font-normal text-[#06164a] mb-4",style:{fontFamily:"'DM Serif Display', serif"},children:"Create a booking"}),e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"text-lg text-amber-900 mb-2",children:"Facility Booking is for Residents Only"}),e.jsx("p",{className:"text-sm text-amber-700",children:c.role==="admin"?"As an admin, you can view and manage bookings from the admin dashboard.":"This feature is only available to residents."})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-4xl md:text-4xl font-normal text-[#06164a] mb-4",style:{fontFamily:"'DM Serif Display', serif"},children:"Create a booking"}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[h&&e.jsxs("div",{className:"bg-rose-50 border border-rose-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-rose-700 text-sm mb-2",children:h}),e.jsx("button",{type:"button",onClick:l,className:"text-sm text-rose-700 underline hover:text-rose-900",children:"Try again"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold mb-2",children:"Facility"}),e.jsx("select",{value:s.facilityId,onChange:t=>m("facilityId",t.target.value),className:"w-full bg-[#07164a] text-white rounded-lg h-12 px-4 disabled:opacity-50 disabled:cursor-not-allowed",required:!0,disabled:o||i.length===0,children:o?e.jsx("option",{value:"",children:"Loading facilities..."}):i.length===0?e.jsx("option",{value:"",children:"No facilities available"}):i.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))}),a.facilityId&&e.jsx("div",{className:"text-xs text-rose-500 mt-1",children:a.facilityId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold mb-2",children:"Booking Title"}),e.jsx("input",{value:s.title,onChange:t=>m("title",t.target.value),className:"w-full bg-[#07164a] text-white rounded-lg h-12 px-4",placeholder:"Enter a short title",required:!0}),a.title&&e.jsx("div",{className:"text-xs text-rose-500 mt-1",children:a.title})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold mb-2",children:"Date"}),e.jsx("input",{type:"date",value:s.date,onChange:t=>m("date",t.target.value),className:"w-full bg-[#07164a] text-white rounded-lg h-12 px-4",required:!0}),a.date&&e.jsx("div",{className:"text-xs text-rose-500 mt-1",children:a.date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold mb-2",children:"Start Time"}),e.jsx("input",{type:"time",value:s.startTime,onChange:t=>m("startTime",t.target.value),className:"w-full bg-[#07164a] text-white rounded-lg h-12 px-4",required:!0}),a.startTime&&e.jsx("div",{className:"text-xs text-rose-500 mt-1",children:a.startTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold mb-2",children:"End Time"}),e.jsx("input",{type:"time",value:s.endTime,onChange:t=>m("endTime",t.target.value),className:"w-full bg-[#07164a] text-white rounded-lg h-12 px-4",required:!0}),a.endTime&&e.jsx("div",{className:"text-xs text-rose-500 mt-1",children:a.endTime})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-semibold mb-2",children:"Note (Optional)"}),e.jsx("textarea",{value:s.note,onChange:t=>m("note",t.target.value),rows:3,className:"w-full bg-[#07164a] text-white rounded-lg p-4",placeholder:"Any additional details"})]}),a.general&&e.jsx("div",{className:"text-sm text-rose-700 bg-rose-50 border border-rose-200 rounded p-3",children:a.general}),y.length>0&&e.jsxs("div",{className:"text-xs text-rose-700 bg-rose-50 border border-rose-200 rounded p-2",children:["Time conflicts with existing bookings:",e.jsx("ul",{className:"list-disc ml-4",children:y.map(t=>e.jsxs("li",{children:[new Date(t.start).toLocaleTimeString()," - ",new Date(t.end).toLocaleTimeString()," â€¢ ",t.title," (",t.status,")"]},t.id))})]}),v&&e.jsx("div",{className:"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded p-2",children:v}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("button",{type:"submit",className:"bg-[#07164a] text-white px-4 py-2 rounded-md hover:bg-[#0a1f6b] transition-colors","aria-label":"Submit booking",children:"Submit Booking"})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-4xl md:text-4xl font-normal text-[#06164a] mb-4",style:{fontFamily:"'DM Serif Display', serif"},children:"Create a booking"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"text-lg text-blue-900 mb-4",children:"Please log in to create a booking"}),e.jsx("a",{href:"/login",className:"inline-block bg-[#07164a] text-white px-6 py-3 rounded-lg hover:bg-[#0a1f6b] transition-colors",children:"Go to Login"})]})]})}const _=[{title:"Live",subtitle:"Calendar View",img:E},{title:"Smart",subtitle:"Conflict Prevention",img:B},{title:"Tiered",subtitle:"Access Rules",img:M},{title:"Auto-",subtitle:"Reminders",img:q},{title:"Admin",subtitle:"Overview Dashboard",img:$},{title:"Booking",subtitle:"History & Analytics",img:A}];function Z(){const[c,f]=n.useState([]),b=n.useRef([]),o=n.useRef(null),h=()=>{const l=document.getElementById("facility-features");l&&l.scrollIntoView({behavior:"smooth"})};return n.useEffect(()=>{const l="gf-dm-serif";if(!document.getElementById(l)){const i=document.createElement("link");i.id=l,i.rel="stylesheet",i.href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap",document.head.appendChild(i)}return o.current=new IntersectionObserver(i=>{i.forEach(r=>{var s;if(r.isIntersecting){const d=Number(r.target.getAttribute("data-index"));f(a=>a.includes(d)?a:[...a,d]),(s=o.current)==null||s.unobserve(r.target)}})},{threshold:.1,rootMargin:"50px"}),b.current.forEach(i=>{var r;i&&((r=o.current)==null||r.observe(i))}),()=>{o.current&&o.current.disconnect()}},[]),e.jsxs("div",{className:"min-h-screen",children:[e.jsx(S,{}),e.jsxs("header",{className:"relative bg-center bg-cover h-[650px] md:h-[740px] flex flex-col items-center justify-center",style:{backgroundImage:`url(${O})`},children:[e.jsx("div",{className:"absolute inset-0 bg-black/55"}),e.jsxs("div",{className:"relative z-10 text-center text-white px-6 mt-20 md:mt-28",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-semibold opacity-0 animate-fadeIn mb-0",children:"Facility Bookings"}),e.jsx("img",{src:R,alt:"Facility Booking Illustration",className:"mx-auto -mt-4 w-72 md:w-[420px] opacity-0 animate-fadeInSlow"}),e.jsx("button",{onClick:h,className:"-mt-6 inline-block bg-[#0f335b] hover:bg-[#173f77] text-white font-semibold px-6 py-2 rounded-md transition-all duration-300 opacity-0 animate-fadeInSlower",children:"Learn More"})]})]}),e.jsx("main",{className:"bg-[#c3c5ce]",children:e.jsxs("section",{id:"facility-features",className:"max-w-none px-4 sm:px-6 py-20",children:[e.jsx("h2",{className:"text-center text-4xl md:text-5xl font-normal mb-14 text-[#06164a]",style:{fontFamily:"'DM Serif Display', serif"},children:"Key Features"}),e.jsx("div",{className:`rounded-xl bg-[#06164a] \r
              px-6 sm:px-10 md:px-20 lg:px-32 xl:px-48 \r
              py-12 mx-auto w-full max-w-[1800px]`,children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-16 gap-y-12",children:_.map(({title:l,subtitle:i,img:r},s)=>e.jsxs("div",{ref:d=>b.current[s]=d,"data-index":s,className:`rounded-xl overflow-hidden border-[3px] border-white/40 bg-white/5 transform transition-all duration-500 ease-out hover:scale-105 hover:bg-white/10 hover:shadow-2xl h-[300px] will-change-transform
                    ${c.includes(s)?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}`,style:{transitionDelay:c.includes(s)?`${s*100}ms`:"0ms"},children:[e.jsx("img",{src:r,alt:`${l} ${i}`,className:"h-[75%] w-full object-cover transition-all duration-300 hover:brightness-110",loading:"lazy"}),e.jsx("div",{className:"h-[25%] p-5 text-center text-white flex items-center justify-center",children:e.jsxs("span",{className:"text-lg font-normal leading-relaxed",children:[l,e.jsx("br",{}),i]})})]},s))})}),e.jsx("div",{className:"mt-12 mx-auto max-w-4xl",children:e.jsx(L,{})})]})}),e.jsx(D,{})]})}export{Z as default};
