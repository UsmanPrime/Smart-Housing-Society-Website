const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CCpieWfV.css","assets/index-DSpZquNv.css"])))=>i.map(i=>d[i]);
import{j as e,N as F,F as A,_ as q}from"./index-BR_n0HI9.js";import{r as a}from"./react-core-Ljpx9oFu.js";import{a as h}from"./api-B_kgTFai.js";import"./vendor-B9ygI19o.js";function B(){const[l,n]=a.useState(!0),[c,y]=a.useState(""),[s,E]=a.useState(null),[m,_]=a.useState([]),[x,b]=a.useState(!1),[p,u]=a.useState(""),[d,f]=a.useState(""),[j,R]=a.useState("bank-transfer"),[N,v]=a.useState(""),[w,S]=a.useState(!1);a.useEffect(()=>{(async()=>{await Promise.all([q(()=>Promise.resolve({}),__vite__mapDeps([0])),q(()=>Promise.resolve({}),__vite__mapDeps([1]))])})()},[]),a.useEffect(()=>{k()},[]);async function k(){await Promise.all([P(),g()])}async function P(t=!0){try{t&&n(!0);const r=await h.get("/api/vendors/earnings");E(r.data),y("")}catch(r){y(r.message||"Failed to load earnings")}finally{t&&n(!1)}}async function g(){try{b(!0);const t=await h.get("/api/vendors/payouts/history");_(t.data),u("")}catch(t){u(t.message||"Failed to load payout history")}finally{b(!1)}}async function C(t){if(t.preventDefault(),!(!d||Number(d)<=0))try{S(!0),await h.post("/api/vendors/payouts/request",{amount:Number(d),method:j,notes:N||void 0}),f(""),v(""),await g()}catch(r){u(r.message||"Failed to request payout")}finally{S(!1)}}return e.jsxs("div",{className:"min-h-screen flex flex-col bg-ng-light",children:[e.jsx(F,{}),e.jsx("main",{className:"flex-grow pt-40 pb-24 px-6",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-ng-blue to-ng-accent rounded-2xl shadow-lg p-10 text-white mb-10",children:[e.jsx("h1",{className:"text-4xl font-normal",style:{fontFamily:"DM Serif Display, serif"},children:"Vendor Earnings"}),e.jsx("p",{className:"mt-2 text-lg opacity-90",style:{fontFamily:"Poppins, sans-serif"},children:"Live earnings analytics & payout management"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-8 space-y-10",children:[e.jsx("h2",{className:"text-2xl font-semibold text-ng-blue mb-4",children:"Overview"}),l&&e.jsx("div",{className:"text-gray-600",children:"Loading earnings..."}),!!c&&e.jsx("div",{className:"p-3 bg-red-50 text-red-700 rounded",children:c}),!l&&!c&&s&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(o,{label:"Total",value:i(s.totals.total,s.currency)}),e.jsx(o,{label:"This Month",value:i(s.totals.month,s.currency)}),e.jsx(o,{label:"This Week",value:i(s.totals.week,s.currency)}),e.jsx(o,{label:"Today",value:i(s.totals.today,s.currency)})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>P(),className:"px-4 py-2 bg-ng-blue text-white rounded hover:bg-blue-700 text-sm",children:"Refresh Earnings"}),e.jsx("button",{onClick:()=>g(),className:"px-4 py-2 bg-ng-accent text-white rounded hover:bg-yellow-600 text-sm",children:"Refresh Payouts"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue mb-3",children:"By Category"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(s.breakdown).map(([t,r])=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("div",{className:"font-medium capitalize",children:t}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Jobs: ",r.count]}),e.jsx("div",{className:"text-lg font-semibold text-green-700",children:i(r.amount,s.currency)})]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-ng-blue mb-3",children:"Timeline (12 weeks)"}),e.jsx("div",{className:"space-y-2",children:s.timeline.map((t,r)=>e.jsxs("div",{className:"flex justify-between border rounded-lg p-3 text-sm",children:[e.jsx("span",{className:"text-gray-700",children:t.label}),e.jsx("span",{className:"font-semibold",children:i(t.amount,s.currency)})]},r))})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-ng-blue mb-4",children:"Request Payout"}),e.jsxs("form",{onSubmit:C,className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (PKR)"}),e.jsx("input",{type:"number",min:"1",value:d,onChange:t=>f(t.target.value),className:"w-full border rounded px-3 py-2 text-sm",required:!0})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Method"}),e.jsxs("select",{value:j,onChange:t=>R(t.target.value),className:"w-full border rounded px-3 py-2 text-sm",children:[e.jsx("option",{value:"bank-transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"wallet",children:"Wallet"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),e.jsx("input",{type:"text",value:N,onChange:t=>v(t.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Account details or reference"})]}),e.jsxs("div",{className:"md:col-span-4 flex items-center gap-3",children:[e.jsx("button",{disabled:w,type:"submit",className:"px-5 py-2 bg-green-600 text-white rounded text-sm disabled:opacity-50",children:w?"Submitting...":"Submit Request"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Requests require admin approval."})]})]}),p&&e.jsx("div",{className:"mt-3 p-2 bg-red-50 text-red-700 rounded text-sm",children:p})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-ng-blue mb-4",children:"Payout History"}),x&&e.jsx("div",{className:"text-gray-600",children:"Loading payout history..."}),!x&&m.length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"No payout requests yet."}),!x&&m.length>0&&e.jsx("div",{className:"space-y-2",children:m.map(t=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between border rounded-lg p-3 text-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:i(t.amount,t.currency)}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.requestedAt||t.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 md:mt-0",children:[e.jsx(L,{status:t.status}),t.method&&e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 rounded",children:t.method}),t.adminComment&&e.jsx("span",{className:"text-xs text-gray-600 italic",children:t.adminComment})]})]},t._id))})]})]})]})}),e.jsx(A,{})]})}function o({label:l,value:n}){return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border",children:[e.jsx("div",{className:"text-sm text-gray-600",children:l}),e.jsx("div",{className:"text-2xl font-semibold text-green-700",children:n})]})}function i(l,n="PKR"){try{return new Intl.NumberFormat("en-PK",{style:"currency",currency:n}).format(l||0)}catch{return`${n} ${Number(l||0).toLocaleString()}`}}function L({status:l}){const n={requested:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",rejected:"bg-red-100 text-red-800",paid:"bg-green-100 text-green-800"};return e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${n[l]||"bg-gray-100 text-gray-700"}`,children:l})}export{B as default};
